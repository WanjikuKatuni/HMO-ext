console.log("been injected");var recorder=null;function onAccessApproved(e){(recorder=new MediaRecorder(e)).start(),recorder.onstop=function(){e.getTracks().forEach((function(e){"Live"===e.readyState&&e.stop()}))},recorder.ondataavailable=function(e){let o=e.data;var n=new FormData;n.append("video",o,"https://amara-hngtask-chrome-extension.onrender.com/api/upload");let t=URL.createObjectURL(o);console.log(t),fetch("https://amara-hngtask-chrome-extension.onrender.com/api/upload",{method:"POST",body:n,redirect:"follow"}).then((e=>e.text())).then((e=>console.log(e))).catch((e=>console.log("error",e)));let r=document.createElement("a");r.style.display="none",r.href=t,r.download=`${t}.mp4`,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t),window.location.assign("https://ellahhh-helpmeout.netlify.app/ready")}}chrome.runtime.onMessage.addListener(((e,o,n)=>{if("request_recording"===e.action&&(console.log("requesting recording"),n(`seen ${e.action}`),navigator.mediaDevices.getDisplayMedia({audio:!0,video:{width:9999999999,height:9999999999}}).then((e=>{onAccessApproved(e)}))),"stopVideo"===e.action){if(console.log("stopping video"),n(`seen ${e.action}`),!recorder)return console.log("no recorder");recorder.stop()}}));