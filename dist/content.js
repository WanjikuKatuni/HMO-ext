console.log("been injected");var recorder=null;function onAccessApproved(e){(recorder=new MediaRecorder(e)).start(),recorder.onstop=function(){e.getTracks().forEach((function(e){"Live"===e.readyState&&e.stop()}))},recorder.ondataavailable=function(e){let o=e.data;var n=new FormData;n.append("video",o,"");let r=URL.createObjectURL(o);console.log(r),fetch("",{method:"POST",body:n,redirect:"follow"}).then((e=>e.text())).then((e=>console.log(e))).catch((e=>console.log("error",e)));let t=document.createElement("a");t.style.display="none",t.href=r,t.download=`${r}.mp4`,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r),window.location.assign("")}}chrome.runtime.onMessage.addListener(((e,o,n)=>{if("request_recording"===e.action&&(console.log("requesting recording"),n(`seen ${e.action}`),navigator.mediaDevices.getDisplayMedia({audio:!0,video:{width:9999999999,height:9999999999}}).then((e=>{onAccessApproved(e)}))),"stopVideo"===e.action){if(console.log("stopping video"),n(`seen ${e.action}`),!recorder)return console.log("no recorder");recorder.stop()}}));